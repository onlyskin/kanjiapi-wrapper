(function(){function b(d,e,g){function a(j,i){if(!e[j]){if(!d[j]){var f="function"==typeof require&&require;if(!i&&f)return f(j,!0);if(h)return h(j,!0);var c=new Error("Cannot find module '"+j+"'");throw c.code="MODULE_NOT_FOUND",c}var k=e[j]={exports:{}};d[j][0].call(k.exports,function(b){var c=d[j][1][b];return a(c||b)},k,k.exports,b,d,e,g)}return e[j].exports}for(var h="function"==typeof require&&require,c=0;c<g.length;c++)a(g[c]);return a}return b})()({1:[function(a,b){"use strict";var{Kanjiapi:c}=a("./dist/kanjiapi-wrapper.js");"undefined"==typeof b?window.Kanjiapi=c:b.exports={Kanjiapi:c}},{"./dist/kanjiapi-wrapper.js":3}],2:[function(a,b,c){"use strict";var d=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};Object.defineProperty(c,"__esModule",{value:!0});var e;(function(a){a.ERROR="ERROR",a.LOADING="LOADING",a.SUCCESS="SUCCESS"})(e=c.Result||(c.Result={}));const f="kanji";c.ApiWrapper=class{constructor(a,b){this._fetch=a,this._apiUrl=b,this._listeners=new Map,this._cache=new Map,this._pending=new Set}addListener(a,b){this._listeners.set(a,b)}removeListener(a){this._listeners.delete(a)}getKanji(a){return this._fromCache(`/${f}/${a}`)}getReading(a){return this._fromCache(`/${"reading"}/${a}`)}getJoyoSet(){return this._asSet(this._fromCache(`/${f}/joyo`))}getJinmeiyoSet(){return this._asSet(this._fromCache(`/${f}/jinmeiyo`))}getListForGrade(a){return this._asSet(this._fromCache(`/${f}/grade-${a}`))}getWordsForKanji(a){return this._fromCache(`/${"words"}/${a}`)}getUrl(a){return this._fromCache(a)}_fromCache(a){return this._cache.has(a)?this._cache.get(a):(this._pending.has(a)||this._apiFetch(a),{status:e.LOADING,value:null})}_apiFetch(a){return d(this,void 0,void 0,function*(){this._pending.add(a);const b=yield this._fetch(`${this._apiUrl}/${"v1"}${a}`);this._cache=this._cache.set(a,{status:200===b.status?e.SUCCESS:e.ERROR,value:200===b.status?yield b.json():b.status});for(const a of this._listeners.values())a()})}_asSet(a){return a.status===e.SUCCESS?{status:a.status,value:new Set(a.value)}:a}}},{}],3:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});const d=a("./api_wrapper");c.Kanjiapi={build:()=>new d.ApiWrapper(window.fetch.bind(window),"https://kanjiapi.dev"),Result:d.Result}},{"./api_wrapper":2}]},{},[1]);
